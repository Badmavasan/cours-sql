<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>TD - Agrégations et GROUP BY</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>


</head>

<body>

<h1 id="toc_0">TD : Agrégations et GROUP BY</h1>

<h2 id="toc_1">Introduction</h2>

<p>Ce TD vous permettra de pratiquer les agrégations et le GROUP BY en SQL à travers une série d&#39;exercices utilisant la base de données TechnoShop. Vous travaillerez sur différents aspects, des agrégations simples aux analyses plus complexes.</p>

<h2 id="toc_2">Partie 1 : Agrégations Simples</h2>

<h3 id="toc_3">Exercice 1.1 : Analyse de Base</h3>

<ol>
<li>Calculez le nombre total de produits par catégorie.</li>
</ol>

<div><pre><code class="language-sql"># category nombre_produits
Peripherals 6
Audio 4
Electronics 3
Gaming 1
Wearables 1
Home Electronics, 1
Home Automation 1</code></pre></div>

<ol>
<li>Trouvez le prix moyen des produits par fournisseur.</li>
</ol>

<div><pre><code class="language-sql"># fournisseur   prix_moyen
TechCorp    789.99
GadgetHouse 519.99
GizmoDepot  369.99
ComputeHub  264.99
PowerUp 164.99
RetroFun    154.99
ElectroWorld    139.99
BestDevices 129.99
Techies 89.99
DeviceCenter    79.99</code></pre></div>

<ol>
<li>Comptez le nombre de commandes par client.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_commandes
John Doe    1
Jane Smith  1
Mike Jones  1
Lisa Brown  1
Paul Green  1
Amy White   1
Mark Davis  1
Sara Wilson 1
Tom Harris  1
Linda Thomas    1
Linda X 0</code></pre></div>

<ol>
<li>Calculez le total des ventes par statut de commande.</li>
</ol>

<div><pre><code class="language-sql"># status    nombre_commandes    total_ventes
Delivered   3   1619.97
UNKNOWN 1   1429.99
Pending 3   939.97
Shipped 3   549.97</code></pre></div>

<h3 id="toc_4">Exercice 1.2 : Analyses des Avis</h3>

<ol>
<li>Calculez la note moyenne par produit.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_avis note_moyenne
Gaming Laptop   1   5.00
Retro Console   1   5.00
Tablet Pro  1   5.00
Smart Home Hub  1   5.00
Smartphone Pro  1   4.00
Smartwatch  1   4.00
4K TV   1   4.00
Bluetooth Speaker   1   4.00
Wireless Earbuds    1   3.00
Gaming Keyboard 1   3.00</code></pre></div>

<ol>
<li>Trouvez le nombre d&#39;avis par client.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_avis
John Doe    1
Jane Smith  1
Mike Jones  1
Lisa Brown  1
Paul Green  1
Amy White   1
Mark Davis  1
Sara Wilson 1
Tom Harris  1
Linda Thomas    1
Linda X 0</code></pre></div>

<ol>
<li>Identifiez la répartition des notes (nombre d&#39;avis par note).</li>
</ol>

<div><pre><code class="language-sql"># rating    nombre_avis pourcentage
5   4   40.00
4   4   40.00
3   2   20.00</code></pre></div>

<h2 id="toc_5">Partie 2 : Groupements Multiples</h2>

<h3 id="toc_6">Exercice 2.1 : Analyse des Ventes</h3>

<ol>
<li>Calculez le total des ventes par catégorie et par mois.</li>
</ol>

<div><pre><code class="language-sql"># category  mois    nombre_commandes    total_ventes
Audio   10  2   239.98
Electronics 9   1   499.99
Electronics 10  2   2419.98
Gaming  9   1   219.99
Home Automation 9   1   129.99
Home Electronics    8   1   699.99
Peripherals 7   1   79.99
Wearables   10  1   249.99</code></pre></div>

<ol>
<li>Trouvez le nombre de commandes par client et par statut.</li>
</ol>

<div><pre><code class="language-sql"># name  status  nombre_commandes    montant_total
Amy White   Delivered   1   499.99
Jane Smith  Delivered   1   989.99
John Doe    UNKNOWN 1   1429.99
Linda Thomas    Delivered   1   129.99
Lisa Brown  Pending 1   149.99
Mark Davis  Pending 1   699.99
Mike Jones  Shipped 1   219.99
Paul Green  Shipped 1   249.99
Sara Wilson Shipped 1   79.99
Tom Harris  Pending 1   89.99</code></pre></div>

<ol>
<li>Analysez les ventes par niveau de fidélité client et catégorie de produit.</li>
</ol>

<div><pre><code class="language-sql"># loyalty_level category    nombre_commandes    total_ventes
New Audio   1   149.99
New Peripherals 1   79.99
Bronze  Electronics 1   499.99
Bronze  Gaming  1   219.99
Silver  Electronics 1   1429.99
Silver  Wearables   1   249.99
Silver  Audio   1   89.99
Gold    Electronics 1   989.99
Gold    Home Electronics    1   699.99
Gold    Home Automation 1   129.99</code></pre></div>

<h3 id="toc_7">Exercice 2.2 : Analyse des Stocks</h3>

<ol>
<li>Calculez le stock total et le nombre de produits par fournisseur et catégorie.</li>
</ol>

<div><pre><code class="language-sql"># fournisseur   category    nombre_produits stock_total
BestDevices Home Automation 1   80
ComputeHub  Electronics 1   90
ComputeHub  Peripherals 1   20
DeviceCenter    Peripherals 1   150
ElectroWorld    Audio   2   205
GadgetHouse Electronics 1   100
GadgetHouse Peripherals 1   0
GizmoDepot  Home Electronics    1   30
GizmoDepot  Peripherals 1   15
PowerUp Wearables   1   120
PowerUp Peripherals 1   8
RetroFun    Gaming  1   75
RetroFun    Peripherals 1   0
TechCorp    Electronics 1   50
TechCorp    Audio   1   0
Techies Audio   1   180</code></pre></div>

<ol>
<li>Identifiez le prix moyen et le stock total par catégorie.</li>
</ol>

<div><pre><code class="language-sql"># category  prix_moyen  stock_total nombre_produits
Audio   129.99  385 4
Electronics 973.32  240 3
Peripherals 61.66   193 6
Wearables   249.99  120 1
Home Automation 129.99  80  1
Gaming  219.99  75  1
Home Electronics    699.99  30  1</code></pre></div>

<ol>
<li>Trouvez les produits sans stock par fournisseur.</li>
</ol>

<div><pre><code class="language-sql"># fournisseur   produits_sans_stock
TechCorp    1
GadgetHouse 1
RetroFun    1</code></pre></div>

<h2 id="toc_8">Partie 3 : Filtres et Conditions</h2>

<h3 id="toc_9">Exercice 3.1 : Filtrage des Résultats</h3>

<ol>
<li>Identifiez les catégories avec plus de 5 produits.</li>
</ol>

<div><pre><code class="language-sql"># category  nombre_produits prix_moyen
Peripherals 6   61.66</code></pre></div>

<ol>
<li>Trouvez les produits avec une note moyenne supérieure à 4.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_avis note_moyenne
Gaming Laptop   1   5.00
Retro Console   1   5.00
Tablet Pro  1   5.00
Smart Home Hub  1   5.00</code></pre></div>

<ol>
<li>Listez les clients ayant passé plus de 3 commandes.</li>
</ol>

<div><pre><code class="language-sql">INSERT INTO orders (customer_id, order_date, status, total_amount, delivery_address)
VALUES
(1, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(1, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(1, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;);

INSERT INTO orders (customer_id, order_date, status, total_amount, delivery_address)
VALUES
(5, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(5, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(5, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(5, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;),
(5, &#39;2023-10-15 14:30:00&#39;, &#39;UNKNOWN&#39;, 1429.99, &#39;123 Elm Street, Cityville&#39;);</code></pre></div>

<div><pre><code class="language-sql"># name  nombre_commandes    montant_total
Paul Green  6   7399.94
John Doe    4   5719.96</code></pre></div>

<h3 id="toc_10">Exercice 3.2 : Analyses Avancées</h3>

<ol>
<li>Identifiez les produits dont le prix est supérieur à la moyenne de leur catégorie.</li>
</ol>

<div><pre><code class="language-sql"># name  category    price   moyenne_categorie
Wireless Earbuds    Audio   149.99  129.99
Casque Gaming Pro X Audio   149.99  129.99
Gaming Laptop   Electronics 1429.99 973.32
Smartphone Pro  Electronics 989.99  973.32
Webcam HD Pro   Peripherals 89.99   61.66
Gaming Keyboard Peripherals 79.99   61.66
Clavier Rétroéclairé    Peripherals 79.99 61.66</code></pre></div>

<ol>
<li>Trouvez les fournisseurs dont le stock total est supérieur à la moyenne.</li>
</ol>

<div><pre><code class="language-sql"># name  stock_total
ElectroWorld    205
Techies 180
DeviceCenter    150
PowerUp 128</code></pre></div>

<ol>
<li>Listez les clients dont le montant moyen des commandes dépasse 500€.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_commandes    montant_moyen
John Doe    4   1429.99
Paul Green  6   1233.32
Jane Smith  1   989.99
Mark Davis  1   699.99</code></pre></div>

<h2 id="toc_11">Partie 4 : Cas Pratiques</h2>

<h3 id="toc_12">Exercice 4.1 : Support Client</h3>

<ol>
<li>Analysez le nombre de tickets support par statut et niveau de fidélité.</li>
</ol>

<div><pre><code class="language-sql"># loyalty_level status  nombre_tickets
New Resolved    1
New Open    1
Bronze  Pending 1
Bronze  Closed  1
Silver  Open    2
Silver  Closed  1
Gold    Closed  1
Gold    Pending 1
Gold    Open    1</code></pre></div>

<ol>
<li>Calculez le nombre moyen de tickets par client et catégorie de produit.</li>
</ol>

<div><pre><code class="language-sql"># category  nombre_tickets  nombre_clients  tickets_par_client
Audio   2   2   1.00
Electronics 3   3   1.00
Gaming  1   1   1.00
Home Automation 1   1   1.00
Home Electronics    1   1   1.00
Peripherals 1   1   1.00
Wearables   1   1   1.00</code></pre></div>

<ol>
<li>Identifiez les produits générant le plus de tickets support. Vous pouvez essayer avec <code>nombre_commandes &gt;=1</code>.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_tickets  nombre_commandes    pourcentage_problemes
Gaming Laptop   1   1   100.00
Smartphone Pro  1   1   100.00
Retro Console   1   1   100.00
Wireless Earbuds    1   1   100.00
Smartwatch  1   1   100.00
Tablet Pro  1   1   100.00
4K TV   1   1   100.00
Gaming Keyboard 1   1   100.00
Bluetooth Speaker   1   1   100.00
Smart Home Hub  1   1   100.00</code></pre></div>

<h3 id="toc_13">Exercice 4.2 : Analyse des Commandes</h3>

<ol>
<li>Analysez la distribution des commandes par jour de la semaine.</li>
</ol>

<div><pre><code class="language-sql"># jour_semaine  nombre_commandes    montant_moyen   total_ventes
Sunday  11  1201.81 13219.89
Monday  1   79.99   79.99
Tuesday 2   599.99  1199.98
Wednesday   1   249.99  249.99
Friday  1   149.99  149.99
Saturday    2   539.99  1079.98</code></pre></div>

<ol>
<li>Identifiez les produits les plus souvent commandés ensemble.</li>
</ol>

<div><pre><code class="language-sql">INSERT INTO order_items (order_id, product_id, quantity, price_at_time)
VALUES
(1, 2, 1, 1429.99);</code></pre></div>

<div><pre><code class="language-sql"># produit1  produit2    nombre_commandes_communes
Gaming Laptop   Smartphone Pro  1</code></pre></div>

<h2 id="toc_14">Exercices Bonus</h2>

<h3 id="toc_15">Bonus 1 : Analyse Temporelle</h3>

<ol>
<li>Calculez les ventes quotidiennes moyennes par mois.</li>
</ol>

<div><pre><code class="language-sql"># mois  nombre_jours    nombre_commandes    commandes_par_jour  ventes_quotidiennes_moyennes
7   1   1   1.00    79.99
8   1   1   1.00    699.99
9   2   3   1.50    424.99
10  5   13  2.60    2869.97</code></pre></div>

<ol>
<li>Identifiez les pics de vente par jour de la semaine.</li>
</ol>

<div><pre><code class="language-sql"># jour_semaine  nombre_commandes    panier_moyen    total_ventes    pourcentage_commandes
Sunday  11  1201.81 13219.89    61.11
Monday  1   79.99   79.99   5.56
Tuesday 2   599.99  1199.98 11.11
Wednesday   1   249.99  249.99  5.56
Friday  1   149.99  149.99  5.56
Saturday    2   539.99  1079.98 11.11</code></pre></div>

<ol>
<li>Analysez l&#39;évolution des notes moyennes des produits dans le temps. Attention, la date montrée changera en fonction de la data d&#39;exécution de la requête.</li>
</ol>

<div><pre><code class="language-sql"># date_avis nombre_avis note_moyenne    note_min    note_max
2025-02-18  10  4.20    3   5</code></pre></div>

<h3 id="toc_16">Bonus 2 : Analyse de Performance</h3>

<ol>
<li>Identifiez les meilleurs clients par montant total d&#39;achats.</li>
</ol>

<div><pre><code class="language-sql"># name  loyalty_level   nombre_commandes    panier_moyen    total_achats
Paul Green  Silver  6   1233.32 7399.94
John Doe    Silver  4   1429.99 5719.96
Jane Smith  Gold    1   989.99  989.99
Mark Davis  Gold    1   699.99  699.99
Amy White   Bronze  1   499.99  499.99
Mike Jones  Bronze  1   219.99  219.99
Lisa Brown  New 1   149.99  149.99
Linda Thomas    Gold    1   129.99  129.99
Tom Harris  Silver  1   89.99   89.99
Sara Wilson New 1   79.99   79.99</code></pre></div>

<ol>
<li>Trouvez les produits les plus rentables par catégorie.</li>
</ol>

<div><pre><code class="language-sql"># category  name    nombre_ventes   revenu_total    prix_moyen_vente    nombre_clients_uniques
Electronics Smartphone Pro  2   2419.98 1209.99 2
Electronics Gaming Laptop   1   1429.99 1429.99 1
Home Electronics    4K TV   1   699.99  699.99  1
Electronics Tablet Pro  1   499.99  499.99  1
Wearables   Smartwatch  1   249.99  249.99  1
Gaming  Retro Console   1   219.99  219.99  1
Audio   Wireless Earbuds    1   149.99  149.99  1
Home Automation Smart Home Hub  1   129.99  129.99  1
Audio   Bluetooth Speaker   1   89.99   89.99   1
Peripherals Gaming Keyboard 1   79.99   79.99   1</code></pre></div>

<ol>
<li>Analysez la corrélation entre les avis et les ventes.</li>
</ol>

<div><pre><code class="language-sql"># name  nombre_avis note_moyenne    ventes_apres_avis   revenu_total    ratio_ventes_avis
Smartphone Pro  1   4.00    2   2419.98 2.00
Gaming Laptop   1   5.00    1   1429.99 1.00
Retro Console   1   5.00    1   219.99  1.00
Wireless Earbuds    1   3.00    1   149.99  1.00
Smartwatch  1   4.00    1   249.99  1.00
Tablet Pro  1   5.00    1   499.99  1.00
4K TV   1   4.00    1   699.99  1.00
Gaming Keyboard 1   3.00    1   79.99   1.00
Bluetooth Speaker   1   4.00    1   89.99   1.00
Smart Home Hub  1   5.00    1   129.99  1.00</code></pre></div>

<h2 id="toc_17">Notes et Conseils</h2>

<ul>
<li>Commencez toujours par des requêtes simples</li>
<li>Vérifiez vos résultats sur un petit échantillon</li>
<li>Utilisez des alias explicites pour plus de clarté</li>
<li>Pensez à gérer les cas NULL dans vos agrégations</li>
</ul>




</body>

</html>
